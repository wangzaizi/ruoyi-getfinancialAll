<<<<<<< HEAD
# 中国地级行政区划财政报告爬虫

这是一个用于爬取中华人民共和国334个地级行政区划（地级市、地区、自治州、盟等）财政决算报告的爬虫程序。

## 功能特点

- 自动搜索334个地级行政区划的政府网站
- 智能识别和下载财政决算报告（PDF、Word、Excel等格式）
- 支持断点续传，自动保存进度
- 详细的日志记录和错误处理
- 并发控制和请求延迟，避免过度访问

## 目录结构

```
.
├── spider.py          # 主爬虫程序
├── config.py          # 配置文件
├── cities_data.py     # 334个地级行政区划数据
├── requirements.txt   # Python依赖包
├── README.md          # 说明文档
├── downloads/         # 下载的文件目录（按城市分类）
├── logs/             # 日志文件目录
└── data/             # 数据文件目录（进度、摘要等）
```

## 安装依赖

```bash
pip install -r requirements.txt
```

## 使用方法

### 测试模式（推荐先测试）

在运行完整爬取之前，建议先使用测试模式验证功能：

```bash
python test_spider.py
```

或者使用交互式启动脚本：

```bash
python run.py
# 选择选项 1 进入测试模式
```

测试模式会爬取少量城市（默认：赣州市、北京市、上海市、杭州市、深圳市），可以用来验证：
- 网络连接是否正常
- 政府网站是否可以访问
- 文件下载功能是否正常

### 完整模式

运行完整爬取所有334个城市：

```bash
python spider.py
```

或者使用交互式启动脚本：

```bash
python run.py
# 选择选项 2 进入完整模式
```

程序会自动：
1. 遍历334个地级行政区划
2. 搜索每个城市的政府网站
3. 查找2024年财政决算报告相关页面
4. 下载PDF等格式的报告文件
5. 保存到 `downloads/[城市名]/` 目录下

### 配置说明

可以在 `config.py` 中修改以下配置：

- `TARGET_YEAR`: 目标年份（默认：2024）
- `CONCURRENT_REQUESTS`: 并发请求数（默认：5）
- `REQUEST_DELAY`: 请求延迟秒数（默认：2秒）
- `TIMEOUT`: 请求超时时间（默认：30秒）
- `MAX_RETRIES`: 最大重试次数（默认：3次）
- `SEARCH_KEYWORDS`: 搜索关键词列表
- `TARGET_FILE_TYPES`: 目标文件类型

### 查看进度

程序运行过程中会自动保存进度到 `data/progress.json`，可以随时查看。

最终结果会保存到 `data/summary.json`，包含：
- 总城市数
- 成功爬取的城市数
- 失败的城市数
- 总下载文件数
- 每个城市的详细结果

## 报告类型

程序会搜索以下类型的财政报告：

- **一般公共预算决算报告**
- **政府性基金预算决算报告**
- **国有资本经营预算决算报告**
- **社会保险基金预算决算报告**
- **地方政府债务报告**
- **决算公开目录**

## 注意事项

1. **网络环境**：确保网络连接正常，某些政府网站可能需要特定的网络环境访问

2. **访问频率**：程序已设置请求延迟，避免对目标网站造成过大压力

3. **网站结构**：不同城市的政府网站结构可能不同，程序会尝试多种搜索策略

4. **数据完整性**：由于网站结构和内容差异，可能无法获取所有城市的完整报告

5. **法律合规**：请确保爬取行为符合相关法律法规和网站使用条款

## 故障排查

### 如果某个城市下载失败：

1. 检查日志文件 `logs/spider_YYYYMMDD.log`
2. 查看 `data/summary.json` 中该城市的错误信息
3. 可以手动访问该城市的政府网站，检查报告是否已发布

### 常见问题：

- **未找到政府网站**：某些城市可能使用非标准的域名结构
- **未找到财政报告**：报告可能在其他栏目或使用不同的命名方式
- **下载失败**：可能是网络问题或文件链接失效

## 技术支持

如遇问题，请查看日志文件获取详细信息。

## 许可证

本项目仅供学习和研究使用。

=======
# ruoyi-getfinancialAll
>>>>>>> 3646b15a7b0980247239f899bb2916bfe5bb1fcc
